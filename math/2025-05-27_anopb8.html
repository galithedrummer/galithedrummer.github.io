<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>小学3年生算数テスト 第4セット</title>
  <style>
    body {
      font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
      background: #f4f6fb;
      margin: 0;
      padding: 0;
      color: #333;
    }

    .container {
      max-width: 800px;
      margin: auto;
      padding: 20px;
      background: white;
      border-radius: 16px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
      margin-top: 40px;
    }

    h1 {
      font-size: 26px;
      text-align: center;
      color: #2c3e50;
      margin-bottom: 30px;
    }

    .question {
      margin-bottom: 28px;
      padding: 20px;
      border-radius: 12px;
      background: #f8faff;
      border: 1px solid #dde3ef;
    }

    .question-title {
      font-weight: 600;
      font-size: 18px;
      margin-bottom: 12px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .option-label {
      display: flex;
      align-items: center;
      border: 2px solid transparent;
      border-radius: 10px;
      background: #eef2f9;
      padding: 10px 14px;
      cursor: pointer;
      transition: 0.3s ease;
    }

    .option-label:hover {
      background: #dbe7ff;
    }

    .option-label input[type="radio"] {
      display: none;
    }

    .option-label.selected {
      background-color: #cce4ff !important;
      border-color: #3390ff;
    }

    .opt-prefix {
      font-weight: bold;
      margin-right: 8px;
      color: #333;
    }

    .opt-content {
      font-size: 16px;
    }

    button {
      margin-top: 30px;
      display: block;
      width: 100%;
      background: #3390ff;
      color: white;
      border: none;
      padding: 14px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background: #2273d6;
    }

    #result {
      font-size: 20px;
      font-weight: bold;
      margin-top: 30px;
      text-align: center;
      color: #2e8b57;
    }

    .feedback {
      margin-top: 10px;
    }

    .incorrect {
      background-color: #ffe8e8;
      border: 2px solid #ff4d4f;
      border-radius: 6px;
      padding: 4px 8px;
      display: inline-block;
    }

    #score-popup {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #ffffff;
      padding: 20px;
      border: 1px solid #ccd;
      font-size: 16px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 999;
      width: 340px;
      font-family: 'Segoe UI', sans-serif;
    }

    #score-popup h4 {
      margin: 0;
      font-size: 18px;
      color: #003366;
    }

    #score-popup button {
      background-color: #ccc;
      color: #333;
      border: none;
      border-radius: 6px;
      padding: 4px 10px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
    }

    @media (max-width: 600px) {
      .container {
        margin-top: 20px;
        padding: 16px;
      }

      #score-popup {
        width: 90%;
        left: 5%;
        right: auto;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>小学3年生算数テスト 第4セット</h1>
    <form id="quizForm">
      
      <div class="question">
        <div class="question-title">1. 縦12cm、横15cm の長方形の面積は？</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q1" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">175</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q1" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">185</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q1" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">180</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q1" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">190</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">2. 次の計算をしなさい: 550 - 277 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q2" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">260</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q2" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">269</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q2" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">292</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q2" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">273</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">3. 次の計算をしなさい: 9 × 8 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q3" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">82</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q3" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">63</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q3" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">72</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q3" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">65</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">4. 次の計算をしなさい: 8 × (24 ÷ 9) = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q4" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">13</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q4" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">19</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q4" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">16</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q4" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">18</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">5. 1 L 828 mL を mL で表すと？</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q5" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">1828</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q5" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">1728</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q5" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">1928</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q5" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">1628</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">6. 648 の一の位の数字は何ですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q6" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">5</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q6" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">9</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q6" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">2</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q6" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">8</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">7. 次の計算をしなさい: 162 ÷ 2 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q7" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">81</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q7" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">83</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q7" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">78</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q7" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">84</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">8. 1時間47分 は何分ですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q8" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">97</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q8" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">122</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q8" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">117</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q8" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">107</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">9. 10円玉を5枚集めると、合計はいくらですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q9" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">100円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q9" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">50円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q9" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">0円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q9" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">150円</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">10. 次の計算をしなさい: 588 × 9 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q10" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">5262</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q10" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">5322</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q10" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">5342</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q10" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">5292</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">11. 次の計算をしなさい: 6 × (20 ÷ 2) = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q11" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">60</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q11" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">62</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q11" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">58</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q11" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">63</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">12. 次の計算をしなさい: 7 × 8 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q12" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">55</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q12" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">53</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q12" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">56</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q12" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">54</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">13. 11時20分 の 35分後 は何時何分ですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q13" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">12時05分</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q13" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">12時00分</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q13" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">11時45分</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q13" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">11時55分</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">14. 次の計算をしなさい: 7 × 6 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q14" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">34</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q14" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">42</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q14" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">48</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q14" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">39</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">15. 次の計算をしなさい: 8 × 6 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q15" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">52</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q15" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">45</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q15" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">48</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q15" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">57</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">16. 商とあまりを求めなさい: 309 ÷ 7 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q16" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">46余り6</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q16" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">43余り4</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q16" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">44余り1</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q16" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">43余り2</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">17. 827 の一の位の数字は何ですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q17" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">5</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q17" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">3</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q17" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">4</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q17" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">7</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">18. 次の計算をしなさい: 3 × (21 ÷ 7) = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q18" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">7</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q18" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">11</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q18" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">6</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q18" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">9</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">19. 縦9cm、横9cm の長方形の面積は？</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q19" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">76</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q19" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">71</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q19" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">81</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q19" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">91</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">20. 商とあまりを求めなさい: 325 ÷ 7 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q20" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">44余り3</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q20" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">43余り2</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q20" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">46余り3</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q20" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">43余り5</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">21. 次の計算をしなさい: 339 × 7 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q21" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">2373</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q21" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">2403</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q21" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">2323</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q21" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">2353</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">22. 500円を出して357円の品物を買いました。おつりはいくらですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q22" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">173円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q22" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">143円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q22" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">193円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q22" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">93円</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">23. 商とあまりを求めなさい: 394 ÷ 7 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q23" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">55余り0</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q23" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">58余り5</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q23" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">55余り5</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q23" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">56余り2</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">24. 次の計算をしなさい: 8 × 7 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q24" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">59</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q24" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">50</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q24" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">56</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q24" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">51</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">25. 次の計算をしなさい: 866 - 243 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q25" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">617</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q25" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">620</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q25" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">642</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q25" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">623</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">26. 1時00分 の 40分後 は何時何分ですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q26" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">1時30分</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q26" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">1時40分</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q26" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">1時50分</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q26" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">1時45分</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">27. 商とあまりを求めなさい: 156 ÷ 7 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q27" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">24余り2</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q27" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">19余り6</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q27" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">20余り1</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q27" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">22余り2</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">28. 次の計算をしなさい: 335 + 423 = ?</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q28" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">759</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q28" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">758</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q28" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">776</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q28" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">747</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">29. 654 の一の位の数字は何ですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q29" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">2</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q29" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">3</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q29" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">7</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q29" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">4</span>
          </label>
          
        </div>
      </div>
      
      <div class="question">
        <div class="question-title">30. 500円玉を6枚集めると、合計はいくらですか。</div>
        <div class="options">
          
          <label class="option-label">
            <input type="radio" name="q30" value="A">
            <span class="opt-prefix">A.</span>
            <span class="opt-content">3000円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q30" value="B">
            <span class="opt-prefix">B.</span>
            <span class="opt-content">3100円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q30" value="C">
            <span class="opt-prefix">C.</span>
            <span class="opt-content">2900円</span>
          </label>
          
          <label class="option-label">
            <input type="radio" name="q30" value="D">
            <span class="opt-prefix">D.</span>
            <span class="opt-content">2950円</span>
          </label>
          
        </div>
      </div>
      
      <button type="button" onclick="gradeQuiz()">提出する</button>
    </form>
    <div id="result"></div>
  </div>

  <div id="score-popup">
    <div style="display:flex; justify-content: space-between; align-items: center;">
      <h4>過去の成績</h4>
      <button onclick="this.parentNode.parentNode.remove()">✖</button>
    </div>
    <hr style="margin:10px 0; border:none; border-top:1px solid #ccc">
    <div id="score-log" style="line-height:1.6">読み込み中...</div>
  </div>

  <script>
  const answers = [
    
    { num: 1, answer: 'C', correct: `180`, question: `縦12cm、横15cm の長方形の面積は？` },
    
    { num: 2, answer: 'D', correct: `273`, question: `次の計算をしなさい: 550 - 277 = ?` },
    
    { num: 3, answer: 'C', correct: `72`, question: `次の計算をしなさい: 9 × 8 = ?` },
    
    { num: 4, answer: 'C', correct: `16`, question: `次の計算をしなさい: 8 × (24 ÷ 9) = ?` },
    
    { num: 5, answer: 'A', correct: `1828`, question: `1 L 828 mL を mL で表すと？` },
    
    { num: 6, answer: 'D', correct: `8`, question: `648 の一の位の数字は何ですか。` },
    
    { num: 7, answer: 'A', correct: `81`, question: `次の計算をしなさい: 162 ÷ 2 = ?` },
    
    { num: 8, answer: 'D', correct: `107`, question: `1時間47分 は何分ですか。` },
    
    { num: 9, answer: 'B', correct: `50円`, question: `10円玉を5枚集めると、合計はいくらですか。` },
    
    { num: 10, answer: 'D', correct: `5292`, question: `次の計算をしなさい: 588 × 9 = ?` },
    
    { num: 11, answer: 'A', correct: `60`, question: `次の計算をしなさい: 6 × (20 ÷ 2) = ?` },
    
    { num: 12, answer: 'C', correct: `56`, question: `次の計算をしなさい: 7 × 8 = ?` },
    
    { num: 13, answer: 'D', correct: `11時55分`, question: `11時20分 の 35分後 は何時何分ですか。` },
    
    { num: 14, answer: 'B', correct: `42`, question: `次の計算をしなさい: 7 × 6 = ?` },
    
    { num: 15, answer: 'C', correct: `48`, question: `次の計算をしなさい: 8 × 6 = ?` },
    
    { num: 16, answer: 'C', correct: `44余り1`, question: `商とあまりを求めなさい: 309 ÷ 7 = ?` },
    
    { num: 17, answer: 'D', correct: `7`, question: `827 の一の位の数字は何ですか。` },
    
    { num: 18, answer: 'D', correct: `9`, question: `次の計算をしなさい: 3 × (21 ÷ 7) = ?` },
    
    { num: 19, answer: 'C', correct: `81`, question: `縦9cm、横9cm の長方形の面積は？` },
    
    { num: 20, answer: 'C', correct: `46余り3`, question: `商とあまりを求めなさい: 325 ÷ 7 = ?` },
    
    { num: 21, answer: 'A', correct: `2373`, question: `次の計算をしなさい: 339 × 7 = ?` },
    
    { num: 22, answer: 'B', correct: `143円`, question: `500円を出して357円の品物を買いました。おつりはいくらですか。` },
    
    { num: 23, answer: 'D', correct: `56余り2`, question: `商とあまりを求めなさい: 394 ÷ 7 = ?` },
    
    { num: 24, answer: 'C', correct: `56`, question: `次の計算をしなさい: 8 × 7 = ?` },
    
    { num: 25, answer: 'D', correct: `623`, question: `次の計算をしなさい: 866 - 243 = ?` },
    
    { num: 26, answer: 'B', correct: `1時40分`, question: `1時00分 の 40分後 は何時何分ですか。` },
    
    { num: 27, answer: 'D', correct: `22余り2`, question: `商とあまりを求めなさい: 156 ÷ 7 = ?` },
    
    { num: 28, answer: 'B', correct: `758`, question: `次の計算をしなさい: 335 + 423 = ?` },
    
    { num: 29, answer: 'D', correct: `4`, question: `654 の一の位の数字は何ですか。` },
    
    { num: 30, answer: 'A', correct: `3000円`, question: `500円玉を6枚集めると、合計はいくらですか。` },
    
  ];

  function gradeQuiz() {
    let score = 0;
    const wrongAnswers = [];

    document.querySelectorAll(".feedback").forEach(el => el.remove());

    answers.forEach(a => {
      const questionDiv = document.querySelectorAll(".question")[a.num - 1];
      const selectedInput = document.querySelector(`input[name='q${a.num}']:checked`);
      const allOptions = questionDiv.querySelectorAll("label.option-label");

      allOptions.forEach(label => label.classList.remove("selected"));

      if (selectedInput) {
        const selectedLabel = selectedInput.closest("label");
        selectedLabel.classList.add("selected");

        const selectedLetter = selectedInput.value;
        if (selectedLetter === a.answer) {
          score++;
        } else {
          const selectedText = selectedLabel.querySelector(".opt-content")?.innerText || "未選択";
          const fb = document.createElement("div");
          fb.className = "feedback";
          fb.innerHTML = `正解は：<span class='incorrect'>${a.answer}. ${a.correct}</span>`;
          questionDiv.appendChild(fb);

          wrongAnswers.push({
            num: a.num,
            question: a.question,
            selected: selectedText,
            correct: a.correct,
            correct_letter: a.answer,
            timestamp: new Date().toISOString()
          });
        }
      } else {
        // No selection
        const fb = document.createElement("div");
        fb.className = "feedback";
        fb.innerHTML = `正解は：<span class='incorrect'>${a.answer}. ${a.correct}</span>`;
        questionDiv.appendChild(fb);

        wrongAnswers.push({
          num: a.num,
          question: a.question,
          selected: "未選択",
          correct: a.correct,
          correct_letter: a.answer,
          timestamp: new Date().toISOString()
        });
      }
    });

    document.getElementById("result").innerText = `あなたの得点：${score} / ${answers.length}`;

    // Save score
    const key = location.pathname.split('/').pop() || 'default';
    const scoreStorageURL = 'https://kvdb.io/FrFWQafq3LwK1bVEhs4ER6/' + key;
    const scoreEntry = {
      score: `${score} / ${answers.length}`,
      timestamp: new Date().toISOString()
    };
    fetch(scoreStorageURL)
      .then(r => r.ok ? r.text() : "[]")
      .then(t => {
        let data = [];
        try { data = JSON.parse(t); if (!Array.isArray(data)) data = []; } catch (e) { data = []; }
        data.push(scoreEntry);
        return fetch(scoreStorageURL, {
          method: "PUT",
          body: JSON.stringify(data)
        });
      });

    // Save wrong answers
    if (wrongAnswers.length > 0) {
      const wrongURL = "https://kvdb.io/WitRtAw6rrzZQtarR3gDoW/" + key + "_wrong";
      fetch(wrongURL)
        .then(r => r.ok ? r.text() : "[]")
        .then(t => {
          let data = [];
          try { data = JSON.parse(t); if (!Array.isArray(data)) data = []; } catch (e) { data = []; }
          data.push(...wrongAnswers);
          return fetch(wrongURL, {
            method: "PUT",
            body: JSON.stringify(data)
          });
        });
    }
  }

  // Reapply selected class when option is selected (mobile/PC safe)
  window.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".options").forEach(group => {
      group.querySelectorAll("input[type='radio']").forEach(input => {
        input.addEventListener("change", () => {
          group.querySelectorAll("label.option-label").forEach(label => {
            label.classList.remove("selected");
          });
          input.closest("label").classList.add("selected");
        });
      });
    });

    // Load score log
    const key = location.pathname.split('/').pop() || 'default';
    const storageURL = 'https://kvdb.io/FrFWQafq3LwK1bVEhs4ER6/' + key;
    fetch(storageURL)
      .then(res => res.text())
      .then(t => {
        let entries = JSON.parse(t);
        if (!Array.isArray(entries)) entries = [entries];
        const sorted = entries.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        const log = document.getElementById("score-log");
        log.innerHTML = `<table style="width:100%; border-collapse: collapse;">
          ${sorted.map(e => `
            <tr><td style="padding:6px 4px;"><strong>得点</strong></td><td style="padding:6px 4px;">${e.score}</td></tr>
            <tr><td style="padding:6px 4px;"><strong>時刻</strong></td><td style="padding:6px 4px;">${new Date(e.timestamp).toLocaleString()}</td></tr>
            <tr><td colspan="2"><hr style='border:none;border-top:1px solid #ddd;'></td></tr>
          `).join("")}
        </table>`;
      })
      .catch(() => {
        document.getElementById("score-log").innerText = "記録なし";
      });
  });
</script>

</body>
</html>